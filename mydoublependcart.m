function [dx] = mydoublependcart(x,m1,m2,M,L1,L2,g,d,u,umax,umin)
%limits on controller:
    u(u>umax) = umax;
	u(u<umin) = umin;    
%dynamics equations:
    dx(1,1) = x(2);
    
    dx(2,1) = (M+m1).^(-1).*(u+(-1).*x(2).*d+(-1).*L1.*m1.*x(4).*cos(x(3))+L1.*m1.* ...
  x(4).^2.*sin(x(3)));
    
    dx(3,1) = x(4);
    
    dx(4,1) = (-1).*L1.^(-2).*(M+m1).^(-1).*((-1).*m2.*cos(x(3)).^4+(m1+m2+(-1).* ...
  m2.*sin(x(3)).^2).*sin(x(5)).^2+cos(x(3)).^2.*(m1+m2+(-2).*m2.*sin(x(3)).*sin( ...
  x(5)))).^(-1).*((-1).*L1.^2.*m1.^2.*x(4).*cos(x(3)).^4+(M+m1).*sin(x(3)).* ...
  sin(x(5)).*(L1.*m2.*x(2).*x(4).*sin(x(3))+(g.*L1.*m1+L2.*m2.*x(2).*x(6)).*sin(x(5)) ...
  )+cos(x(3)).^2.*(sin(x(3)).*((M+m1).*(g.*L1.*(m1+m2)+m2.*x(2).*(L1.*x(4)+ ...
  L2.*x(6)))+L1.*L2.*(M+m1).*m2.*x(6).^2.*cos(x(5))+L1.^2.*m1.*m2.*x(4).*sin( ...
  x(5)))+(-1).*L1.*sin(x(5)).*(g.*(M+m1).*m2+L2.*(M+m1).*m2.*x(6).^2.*cos(x(5)) ...
  +L1.*m1.*(m1+m2).*x(4).*sin(x(5))))+cos(x(3)).^3.*((L1.^2.*(m1.^2+2.*M.* ...
  m2+2.*m1.*m2).*x(4).^2+2.*L1.*L2.*(M+m1).*m2.*x(4).*x(6)+L2.^2.*(M+m1).* ...
  m2.*x(6).^2).*sin(x(3))+(-1).*L1.*((-1).*m1.*u+m1.*x(2).*d+L1.*(M+m1).* ...
  m2.*x(4).^2.*sin(x(5))))+cos(x(3)).*sin(x(5)).*(L1.*m2.*x(4).*(L1.*(2.*M+m1).* ...
  x(4)+2.*L2.*(M+m1).*x(6)).*sin(x(3)).^2+L1.*(m1+m2).*(u+(-1).*x(2).*d).* ...
  sin(x(5))+sin(x(3)).*(L1.*m2.*((-1).*u+x(2).*d)+(L1.^2.*(m1.^2+(-1).*M.* ...
  m2).*x(4).^2+L2.^2.*(M+m1).*m2.*x(6).^2).*sin(x(5)))));
    
    dx(5,1) = x(6);
    
    dx(6,1) = L1.^(-1).*L2.^(-1).*(M+m1).^(-1).*((-1).*m2.*cos(x(3)).^4+(m1+m2+(-1) ...
  .*m2.*sin(x(3)).^2).*sin(x(5)).^2+cos(x(3)).^2.*(m1+m2+(-2).*m2.*sin(x(3)).* ...
  sin(x(5)))).^(-1).*((-1).*L1.^2.*m1.*(m1+m2).*x(4).*cos(x(3)).^4+L1.*(M+ ...
  m1).*(m1+m2).*x(2).*x(4).*sin(x(3))+cos(x(3)).^3.*(L1.*(m1+m2).*(u+(-1).* ...
  x(2).*d)+(L1.^2.*m1.*(m1+m2).*x(4).^2+L2.^2.*(M+m1).*m2.*x(6).^2).*sin( ...
  x(3)))+(M+m1).*(g.*L1.*(m1+m2)+L2.*m2.*x(2).*x(6)+L1.*L2.*m2.*x(6).^2.*cos( ...
  x(5))).*sin(x(3)).^2.*sin(x(5))+(1/2).*L1.*(m1+m2).*(2.*x(4).*(L1.*M.*x(4)+L2.* ...
  (M+m1).*x(6)).*sin(2.*x(3))+(-2).*(M+m1).*(g+L2.*x(6).^2.*cos(x(5))).*sin(x(5)) ...
  )+cos(x(3)).^2.*(L1.^2.*m1.*(m1+m2).*x(4)+sin(x(3)).*((M+m1).*(g.*L1.*(m1+ ...
  m2)+L2.*m2.*x(2).*x(6))+L1.*L2.*(M+m1).*m2.*x(6).^2.*cos(x(5))+(-1).* ...
  L1.^2.*m1.*(m1+m2).*x(4).*sin(x(5))))+cos(x(3)).*((L1.^2.*m1.*(m1+m2).* ...
  x(4).^2+L2.^2.*(M+m1).*m2.*x(6).^2).*sin(x(3)).^2.*sin(x(5))+L1.*(m1+m2).* ...
  sin(x(3)).*(L1.*m1.*x(4).^2+(u+(-1).*x(2).*d).*sin(x(5)))+(-1).*L1.*(m1+m2) ...
  .*(u+(-1).*x(2).*d+L1.*(M+m1).*x(4).^2.*sin(x(5)))));
end

